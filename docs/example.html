<!DOCTYPE html>
<html lang="en">
<body>
    <h1>Fruits</h1>

    <form onsubmit="addFruit(event); return false">
        <input type="text" id="input" />
        <input type="submit" value="Add fruit" />
    </form>

    <div id="list">
        <div>
            <p>You have {count} fruits:</p>
            <ul>
                {#fruits}
                    <li>{name}</li>
                {/fruits}
            </ul>
        </div>
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/react/15.6.1/react-dom.min.js"></script>
    <script src="//unpkg.com/mobx@3.1.16/lib/mobx.umd.js"></script>
    <script src="//unpkg.com/mobx-react@4.2.2"></script>
    <script src="//unpkg.com/xus@0.0.3/dist/xus.js"></script>

    <script>
        // create a new state object using mobx (see: https://github.com/mobxjs/mobx)
        var state = mobx.observable({
            fruits: [
                { name: "Mango" },
                { name: "Kiwi" }
            ],
            count: mobx.computed(function() { // 'count' tracks the number of fruits
                return this.fruits.length
            })
        })

        function addFruit(event) { // executed when form is submitted, adds a new item to the 'state.fruits' array
            var input = document.getElementById("input")
            var value = input.value

            state.fruits.push({ name: value })

            input.value = ""
            input.focus()
        }
    </script>

    <script>
        var templateElement = document.getElementById("list")
        var template = templateElement.innerHTML

        // xus is not shipped with React, mobx & mobxReact, we provide them separately:
        var options = { React: React, mobx: mobx, mobxReact: mobxReact }

        // ...aaand, action!
        xus(template, state, options, function(er, newElement) {
            if (er) throw er

            // render the newly generated element using ReactDOM
            ReactDOM.render(newElement, templateElement)

            document.getElementById("input").focus()
        })
    </script>
</body>
</html>
